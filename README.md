# åŸºäºNodeJs å’Œ express æ¡†æ¶çš„æœåŠ¡ç«¯
* ä½¿ç”¨mongoDBæ•°æ®åº“ï¼Œå¼•å…¥mongooseå¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œ
* ä¸€ä¸ªç®€é™‹çš„æ‹›è˜Appæ³¨å†Œä¸ç™»å½•ï¼Œä»¥åŠæ³¨é”€åŠŸèƒ½ï¼Œå¯†ç å‡ä½¿ç”¨MD5åŠ å¯†
* åœ¨çº¿èŠå¤©åŠŸèƒ½ï¼Œå¯å‘é€è¡¨æƒ…ä»¥åŠæ˜¾ç¤ºæœªè¯»æ¶ˆæ¯ç­‰è¦ç´ 
* é»˜è®¤ç«¯å£ï¼š5000
* æ•°æ®åº“çº¦æŸï¼Œä»¥åŠå­—æ®µ

  ç”¨æˆ·æ•°æ®Schema:   users
  |    å­—æ®µå    | å­—æ®µç±»å‹ | æ˜¯å¦å¿…è¦ |
  | :----------: | :------: | :------: |
  |   username   |  String  |    æ˜¯    |
  |   password   |  String  |    æ˜¯    |
  |   useType    |  String  |    å¦    |
  |    avatar    |  String  |    å¦    |
  |   position   |  String  |    å¦    |
  | personalInfo |  String  |    å¦    |
  | companyInfo  |  String  |    å¦    |
  |    salary    |  String  |    å¦    |

  èŠå¤©æ•°æ®Schema:   chat
  |   å­—æ®µå    | å­—æ®µç±»å‹ |  æ˜¯å¦å¿…è¦   |
  | :---------: | :------: | :---------: |
  |   from_id   |  String  |     æ˜¯      |
  |    to_id    |  String  |     æ˜¯      |
  |   chat_id   |  String  |     æ˜¯      |
  |   content   |  String  |     æ˜¯      |
  |   hasRead   | Boolean  | é»˜è®¤ä¸ºfalse |
  | create_time |  Number  |     å¦      |
    * from_id å‘é€è€…id
    * to_id æ¥å—è€…id
    * chat_id èŠå¤©ä¼šè¯idï¼Œç”±å‘é€æ¥å—è€…å…±åŒå†³å®š
    * content èŠå¤©å†…å®¹
    * hasRead å¯¹æ–¹æ˜¯å¦å·²è¯»
    * create_time åˆ›å»ºæ—¶é—´ï¼Œæ’åºä½¿ç”¨
* æ¥å£ï¼ˆAPIï¼‰ï¼š
  * ç”¨æˆ·æ³¨å†Œæ¥å£
    * è·¯å¾„ï¼š/register
    * è¯·æ±‚æ–¹å¼ï¼šPOST
    * æ¥æ”¶å‚æ•°ï¼š
      * username 
      * password
      * userType
    * æ³¨å†ŒæˆåŠŸï¼šè¿”å›æ•°æ®ï¼Œå¹¶ä¸”è®¾ç½®cookieä¸ºæ•°æ®åº“ç”Ÿæˆçš„ç”¨æˆ·id
      ```js
      {code:0,data:{ _id:'xxx', username:'xxx'}}
      ```
    * æ³¨å†Œå¤±è´¥ï¼šè¿”å›
      ```js
      {code:1,msg: 'ç”¨æˆ·åå·²å­˜åœ¨ï¼Œæˆ–ä¸å¯ä½¿ç”¨'}
      ```
  * ç”¨æˆ·ç™»é™†æ¥å£
    * è·¯å¾„ï¼š/login
    * è¯·æ±‚æ–¹å¼ï¼šPOST
    * æ¥æ”¶å‚æ•°ï¼š
      * username
      * password
    * ç™»é™†æˆåŠŸï¼šè¿”å›æ•°æ®ï¼Œå¹¶ä¸”è®¾ç½®cookieä¸ºæ•°æ®åº“ç”Ÿæˆçš„ç”¨æˆ·id
      ```js
      {code:0,data:userDoc}
      ```
    * ç™»é™†å¤±è´¥ï¼šè¿”å›
      ```js
      {code:1,msg:'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯'}
      ```
  * æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ¥å£
    * è·¯å¾„ï¼š/update-user-data
    * è¯·æ±‚æ–¹å¼ï¼šPOST
    * æ¥æ”¶å‚æ•°ï¼š
      * name çœŸå®å§“å
      * avatar å¤´åƒä¿¡æ¯
      * position èŒä½ä¿¡æ¯ï¼ˆè€æ¿ï¼‰
      * personalInfo èŒä½è¦æ±‚ã€ä¸ªäººç®€ä»‹
      * companyInfo å…¬å¸ä¿¡æ¯ ï¼ˆè€æ¿ï¼‰
      * salary è–ªèµ„ä¿¡æ¯ï¼ˆè€æ¿ï¼‰
    * cookieä¸å­˜åœ¨ï¼Œè¿”å›
      ```js
      {code:1,msg:'è¯·å…ˆç™»å½•'}
      ```
    * æ›´æ–°æˆåŠŸï¼š
      ```js
      {code:0,data:user}
      ```
    * idæŸ¥æ‰¾åˆ°çš„ä¿¡æ¯ä¸å­˜åœ¨ï¼Œæ›´æ–°å¤±è´¥ï¼Œè¿”å›
      ```js
      {code:1,msg:'è¯·å…ˆç™»å½•'}
      ```
  * è·å–ç”¨æˆ·ä¿¡æ¯æ¥å£ï¼ˆè‡ªåŠ¨ç™»å½•ï¼‰
    * è·¯å¾„ï¼š/get-user-data
    * è¯·æ±‚æ–¹å¼ï¼šGET
    * æ¥æ”¶å‚æ•°ï¼š
      * userId cookieä¸­çš„userId
    * æ‰¾ä¸åˆ°userId å¯¹åº”çš„ç”¨æˆ·ä¿¡æ¯ï¼Œè¿”å›
      ```js
      {code:1,msg:'è¯·å…ˆç™»å½•'}
      ```
    * æ‰¾åˆ°äº†ï¼Œå¹¶ä¸”è¿”å›userIdå¯¹åº”çš„ç”¨æˆ·ä¿¡æ¯
      ```js
      {code:0,data:user}
      ```
  

  * è·å–ç”¨æˆ·åˆ—è¡¨
    * è·¯å¾„ï¼š/get-user-list
    * è¯·æ±‚æ–¹å¼ï¼šGET
    * æ¥æ”¶å‚æ•°ï¼š
      * userType
    * æ²¡æœ‰ä¿¡æ¯è¿”å›ï¼Œè¿”å›ï¼š
      ```js
      {code:1,msg:'å½“å‰æ— å†…å®¹'}
      ```
    * å¯»æ‰¾åˆ°ä¿¡æ¯ï¼Œè¿”å›ï¼š
      ```js
      {
          "code": 0,
          "data": [
              {
                  "_id": "5f363a7e0b93af2588198b06",
                  "userType": "boss",
                  "username": "ç”¨æˆ·å",
                  "avatar": "å¤´åƒä¿¡æ¯",
                  "companyInfo": "ä¿¡æ¯",
                  "name": "è€æ¿1",
                  "personalInfo": "èŒä½ä¿¡æ¯",
                  "position": "èŒä½ä¿¡æ¯",
                  "salary": "æ²¡æœ‰å·¥èµ„"
              },
              {
                  "_id": "5f393fa9c60c230788b6081d",
                  "userType": "boss",
                  "username": "12121212211",
                  "avatar": "icon-1",
                  "companyInfo": "æˆ‘æ€ä¹ˆçŸ¥é“",
                  "name": "å¼ ä¸‰",
                  "personalInfo": "ä¸ªäººä¿¡æ¯",
                  "position": "èŒä½ä¿¡æ¯",
                  "salary": "æ²¡æœ‰å·¥èµ„"
              }
          ]
      }
      ```
  * èŠå¤©æ¥å£
    * è·å–å½“å‰ç”¨æˆ·æ‰€æœ‰èŠå¤©ä¿¡æ¯åˆ—è¡¨
      * è·¯å¾„ï¼š/get-msg-list
      * è¯·æ±‚æ–¹å¼ï¼šGET
      * æ¥æ”¶å‚æ•°ï¼šæ— 
      * è¿”å›ï¼š
        * æ‰€æœ‰ç”¨æˆ·çš„idï¼Œå§“åä»¥åŠå¤´åƒä¿¡æ¯ï¼Œå› ä¸ºä¸èƒ½ç¡®å®šå‘æŸä¸ªç”¨æˆ·å‘é€ä¿¡æ¯ï¼Œä½¿ç”¨ç”¨æˆ·çš„idä½œä¸ºå¯¹è±¡å±æ€§å
        * å½“å‰ç”¨æˆ·ä¸æŸä¸ªç”¨æˆ·çš„èŠå¤©ä¿¡æ¯æ•°æ®ç»“æ„,chatMessages ä¸ºæ•°ç»„ç±»å‹ï¼Œå†…éƒ¨åŒ…å«å¤šä¸ªèŠå¤©ä¿¡æ¯å¯¹è±¡
        ```js
        {
            "code": 0,
            "data": {
                "users": {
                    "5f378752513bb725bc69278e": {
                        "name": "æå¼º",
                        "avatar": "icon-1"
                    },
                    //...
                },
                "chatMessages": [
                    {
                        "hasRead": true,
                        "_id": "5f3c0595e936c53e60a5001c",
                        "from_id": "5f378752513bb725bc69278e",
                        "to_id": "5f363a7e0b93af2588198b06",
                        "content": "ä½ å¥½ğŸ˜ƒ",
                        "chat_id": "5f363a7e0b93af2588198b06_5f378752513bb725bc69278e",
                        "create_time": "1597769109868"
                    },
                    //...
                ]
            }
        }
        ```
    * ä¿®æ”¹æŒ‡å®šæ¶ˆæ¯ä¸ºå·²è¯»
      * è·¯å¾„ï¼š/has-read-msg
      * è¯·æ±‚æ–¹å¼ï¼šPOST
      * æ¥æ”¶å‚æ•°ï¼šfrom_id
        * from_id å½“å‰æ¶ˆæ¯åˆ—è¡¨ä¸­å¯¹æ–¹çš„id
        * åœ¨ç‚¹å‡»æœªè¯»æ¶ˆæ¯æ—¶ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·å½“å‰è¯·æ±‚ï¼Œä¿®æ”¹
      * è¿”å›ï¼š
        * ```js
          {code: 0,data: count // countè¿”å›ä¿®æ”¹çš„æ¡ç›®æ€»æ•°}
          ```
    * socket.ioæ¥å£
      * url: ws://localhost:5000
      * å®¢æˆ·ç«¯ä½¿ç”¨å•ä¾‹æ¨¡å¼è¿›è¡Œç›‘å¬
